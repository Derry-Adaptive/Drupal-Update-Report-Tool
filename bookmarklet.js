javascript:(function(){let a=["Module Name","Installed Version","Recommended Version"],i=(void 0===window._excludedModules&&(window._excludedModules=new Set),window._excludedModules);function r(e){return e.replace(/<a[^>]*>|<\/a>/g,"").replace(/\(Release notes\)/gi,"").replace(/\s+/g," ").trim()}function u(e){var o=document.querySelector("a.environment-link");return o?(o=o.href,e?(e=e.substring(0,11),o.replace(/^(https?:\/\/)([^.-]+)(.*)/,`$1${e}$3`)):o):(console.warn("No link with class 'environment-link' found."),null)}function t(e){return e.replace(/^8\.x-/,"")}function m(e){return e?((e=e.cloneNode(!0)).querySelectorAll("div, .update-major-version-warning").forEach(e=>e.remove()),r(e.textContent)):""}function p(e){if(!e)return"";e=e.cloneNode(!0);e.querySelectorAll("div").forEach(e=>e.remove());let o=r(e.textContent),l=o.match(/\d+(\.\d+)(\.\d+)?/);return t(o=l?l[0]:o)}function g(e){if(!e)return{machine:"",human:""};let o="",l="";var t,n=e.querySelector("a[href*='drupal.org/project/']");return n&&(t=n.getAttribute("href").match(/project\/([^\/]+)\//))&&(o=t[1].toLowerCase(),l=r(n.textContent)),o||(t=e.querySelector('input[name*="projects"]'))&&(n=t.getAttribute("name").match(/projects\[([^\]]+)\]/))&&(o=n[1].toLowerCase()),l=l||m(e),{machine:o,human:l}}function c(){return(new Date).toISOString().split("T")[0]}function l(e){return e=String(e).replace(/"/g,'""'),/["\n\r,]/.test(e)?`"${e}"`:e}function d(e,o){e=[a,...e.map(e=>[e[1],e[2],e[3]]),...o.map(e=>[e[1],e[2],e[3]])].map(e=>e.map(l).join(",")).join("\n"),o=new Blob([e],{type:"text/csv"}),e=document.createElement("a");e.href=URL.createObjectURL(o),e.download=`drupal updates - ${window.location.hostname} - ${c()}.csv`,document.body.appendChild(e),e.click(),document.body.removeChild(e)}function h(e,o){let l=[];e.forEach(e=>{var o=e[1],e=e[3];"core"!==o&&!o.toLowerCase().includes("drupal core")||l.push("drupal/core-recommended:^"+e,"drupal/core-composer-scaffold:^"+e,"drupal/core-project-message:^"+e,"drupal/core:^"+e)}),o.forEach(e=>{var o=e[0],e=e[3];/[^a-z0-9_]/.test(o)?l.push(`"drupal/${o}:^${e}"`):l.push(`drupal/${o}:^`+e)}),l.length?(console.log("üì¶ Composer command:"),console.log("composer require -W "+l.join(" "))):console.log("No matching modules found.")}function f(o,l){o=[...o.map(e=>({name:e[1],installed:e[2],recommended:e[3]})),...l.map(e=>({name:e[1],installed:e[2],recommended:e[3]}))];if(0===o.length)console.log("No module updates to display in ASCII table.");else{let e=[a,...o.map(e=>[e.name,e.installed,e.recommended])],n=[0,0,0];e.forEach(e=>{e.forEach((e,o)=>{var l=2===o?20:100,e=String(e);n[o]=Math.max(n[o],Math.min(l,e.length))})});l=t("+","+","+","="),o=t("+","+","+"),l=["Site: "+window.location.origin,"Date: "+c(),o,r(e[0]),l,...e.slice(1).map(r),o];function t(e,o,l,t="-"){return e+n.map(e=>t.repeat(e+2)).join(o)+l}function r(e){return"| "+e.map((e,o)=>{e=String(e);return(e.length>n[o]?e.substring(0,n[o]-3)+"...":e).padEnd(n[o])}).join(" | ")+" |"}console.log("üìö ASCII table output:\n"),console.log(l.join("\n"))}}function y(e,o){let l=[`Update Drupal modules (${c()})`];e.length&&(l.push("\nCore updates:"),e.forEach(e=>{l.push(e[1]+` (${e[2]} ‚Üí ${e[3]})`)})),o.length&&(l.push("\nContrib module updates:"),o.forEach(e=>{l.push(e[1]+` (${e[2]} ‚Üí ${e[3]})`)})),1<l.length?(console.log("üìù Commit message suggestion:"),console.log(l.join("\n"))):console.log("No module updates to include in commit message.")}function v(){let e=document.querySelectorAll("table"),t={core:null,modules:[]};return e.forEach(e=>{"edit-manual-updates"===e.id?t.core=e:"edit-projects"===e.id&&t.modules.push(e)}),t.core&&0!==t.modules.length||e.forEach(e=>{var o,l;e===t.core||t.modules.includes(e)||(o=e.querySelector("thead tr"))&&(o=o.querySelectorAll("th"))&&(l=""===(l=Array.from(o).map(e=>r(e.textContent).toLowerCase()))[0]||l[0].includes("select")||o[0].classList.contains("select-all"),3!==o.length||l?(4===o.length&&l||3===o.length&&1<e.querySelectorAll("tbody tr").length)&&t.modules.push(e):t.core||1!==e.querySelectorAll("tbody tr").length||(t.core=e))}),t}function e(e){if(!e)return[];let n=[];return e.querySelectorAll("tbody tr").forEach(e=>{var o,l,t=e.className||"",e=e.querySelectorAll("td");3<=e.length&&(o=e[0],l=e[1],e=e[2],o=m(o),l=p(l),e=p(e),l)&&e&&l!==e&&n.push(["core",o,l,e,t])}),n}function o(e){let r=[],o=e.querySelectorAll("tbody tr"),l=e.querySelector("thead tr")?.querySelectorAll("th")||[],a=4===l.length&&(""===l[0].textContent.trim()||l[0].classList.contains("select-all"));return o.forEach(e=>{var o,l,t,n=e.className||"",e=e.querySelectorAll("td");e.length<(a?4:3)||(o=e[a?1:0],t=e[a?2:1],e=e[a?3:2],{machine:o,human:l}=g(o),t=p(t),e=p(e),o&&t&&e&&t!==e&&!i.has(o)&&r.push([o,l,t,e,n]))}),r}function x(s,u){if(!s)return[];let e=s.querySelectorAll("tbody tr"),d=[];return e.forEach(r=>{var a=r.className||"",r=r.querySelectorAll("td");if(!(r.length<3)){let e,o,l,t="core",n;if(u)e=r[0],o=r[1],l=r[2],n=m(e);else{var c=s.querySelector("thead tr")?.querySelectorAll("th")||[],c=4===c.length&&(""===c[0].textContent.trim()||c[0].classList.contains("select-all")),r=(e=r[c?1:0],o=r[c?2:1],l=r[c?3:2],g(e));if(t=r.machine,n=r.human,i.has(t))return}c=p(o),r=p(l);c&&r&&c!==r&&d.push([t,n,c,r,a])}}),d}window.generateUpdateReport=function(a="help",e=null,o=null){let l=null,c=null,s=[];if("string"==typeof e&&e&&("add_exclude"===a||"remove_exclude"===a?l=e:"pantheon"===a&&(c=e)),null!==o&&("string"==typeof o?c=o:Array.isArray(o)&&(s=o)),"help"!==a&&a)if("clear"===a)window._excludedModules.clear(),console.log("üßπ Cleared all module exclusions");else{if("add_exclude"===a)return l?(window._excludedModules.add(l.toLowerCase()),void console.log("‚ûï Excluded module: "+l)):void console.log("‚ö†Ô∏è Please provide a module name to exclude");if("remove_exclude"===a)return l?(window._excludedModules.delete(l.toLowerCase()),void console.log("‚úÖ Removed from exclude list: "+l)):void console.log("‚ö†Ô∏è Please provide a module name to remove from exclusion list");if("exclude_list"===a)console.log("üóÑÔ∏è Currently excluded modules:"),console.log([...window._excludedModules].sort().join("\n")||"None");else{let e,o=v(),l=x(o.core,!0),t=[],n=(o.modules.forEach(e=>{e=x(e,!1);t=t.concat(e)}),[...l]),r=[...t];Array.isArray(s)&&0<s.length&&(n=l.filter(o=>s.some(e=>(o[4]||"").includes(e))),r=t.filter(o=>s.some(e=>(o[4]||"").includes(e))),console.log(`Filtered to scopes [${s.join(", ")}]: ${n.length} core, ${r.length} modules`)),"composer"===a?h(n,r):"csv"===a?d(n,r):"commit"===a||"git"===a?y(n,r):"ascii"===a||"table"===a?f(n,r):"modules"===a?console.log("Drush commands for managing modules would go here"):"pantheon"===a?(e=u(c),console.log("üöÄ Pantheon URL: "+e)):(console.log(`‚ö†Ô∏è Unknown report type: "${a}"`),console.log('Run generateUpdateReport("help") for available options'))}}else console.log('‚úÖ "generateUpdateReport" is ready to use'),console.log("Available report types:"),console.log("- composer: Output composer require commands"),console.log("- csv: Export data to a CSV file"),console.log("- commit: Generate a commit message"),console.log("- table: Generate an ASCII table in the console"),console.log("- modules: Drush commands for managing modules"),console.log("- pantheon: Generate Pantheon URL (requires ticketId)"),console.log("- all: Generate all reports"),console.log("\nAdditional commands:"),console.log("- clear: Clear all module exclusions"),console.log("- add_exclude <module_name>: Add a module to the exclude list"),console.log("- remove_exclude <module_name>: Remove a module from the exclude list"),console.log("- exclude_list: List all excluded modules"),console.log("\nUsage examples:"),console.log('generateUpdateReport("composer", null, ["security"])'),console.log('generateUpdateReport("csv", null, ["security"])'),console.log('generateUpdateReport("table")'),console.log('generateUpdateReport("git", null, ["security", "unsupported"])'),console.log('generateUpdateReport("pantheon", "d1234")'),console.log('generateUpdateReport("add_exclude", "module_name")')},generateUpdateReport("help");})()