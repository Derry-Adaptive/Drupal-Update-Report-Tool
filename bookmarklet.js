javascript:(()=>{console.log("🚀 Drupal Update Report Tool (v5.2) initialized.");let s=["Name","Status","Installed","Recommended"],u=window._excludedModules||new Set;function r(){var e=new Date;return String(e.getDate()).padStart(2,"0")+`/${String(e.getMonth()+1).padStart(2,"0")}/`+e.getFullYear()}window._excludedModules=u;var e=(e=(document.querySelector(".update-status")?.innerText||"").match(/Drupal\s+(\d+\.\d+\.\d+)/i))?e[1]:"0.0.0";function d(e){return e.replace(/^8\.x-/,"")}function c(){let c=[];return document.querySelectorAll("table.update tbody tr").forEach(e=>{var o=e.querySelector(".project-update__title a"),t=o?.innerText.trim()||"N/A",o=(o?.href||"").match(/project\/([^\/]+)/),o=o?o[1]:t.toLowerCase().replace(/\s+/g,"_"),r=e.querySelector(".project-update__title")?.innerText.replace(t,"").trim()||"N/A",l=e.querySelector(".project-update__version--recommended a")?.innerText.trim()||"N/A",n=e.querySelector(".project-update__status")?.textContent.trim().toLowerCase()||"",a=e.querySelector(".project-update__status")?.innerHTML.toLowerCase()||"",s=e.querySelector(".project-update__compatibility-details")?.innerText||"";let d="update";n.includes("up to date")?d="current":n.includes("security update required")?d="security":n.includes("not supported")?(n=e.querySelector(".project-update__compatibility-details .compatible"),d=n?"updatable":"unsupported"):a.includes("no available releases found")&&(d="unsupported"),u.has(o.toLowerCase())||c.push({name:t,machine:o,status:d,installed:r,recommended:l,compatibilityText:s})}),c}function p(e){return e=String(e).replace(/"/g,'""'),/["\n\r,]/.test(e)?`"${e}"`:e}console.log("Current Core Version: ",e),window.generateUpdateReport=function(e="help",n="",o=["security","updatable","update"]){if("help"!==e&&e)if("add_exclude"===e)u.add(n.toLowerCase()),console.log("🛑 Excluded: "+n);else if("remove_exclude"===e)u.delete(n.toLowerCase()),console.log("✅ Removed from exclude: "+n);else if("exclude_list"===e)console.log([...u].sort().join("\n")||"No exclusions");else{let l;if(!(l=o.includes("excluded")?c().filter(e=>u.has(e.machine.toLowerCase())):o.includes("all")?c():c().filter(e=>o.includes(e.status))).length)return console.log("✅ No updates found for selected scope.");if("ascii"===e){var a=l;let r=s.map(o=>Math.max(o.length,...a.map(e=>(e[o.toLowerCase()]||"").length)));n=o=>"+"+r.map(e=>o.repeat(e+2)).join("+")+"+";let o=t=>"| "+s.map((e,o)=>(t[e.toLowerCase()]||"").padEnd(r[o])).join(" | ")+" |",t=[];t.push(n("-")),t.push(o(Object.fromEntries(s.map(e=>[e.toLowerCase(),e])))),t.push(n("=")),a.forEach(e=>t.push(o(e))),t.push(n("-")),console.log("```\n"+t.join("\n")+"\n```")}else if("commit"===e){n=l;let e="Drupal updates - "+r(),t={core:[],modules:[],themes:[]};n.forEach(e=>{var o="update"!==e.status?` [${e.status}]`:"",o=e.name+o+` (${e.installed} → ${e.recommended})`;(e.name.toLowerCase().includes("core")?t.core:e.name.toLowerCase().includes("theme")?t.themes:t.modules).push(o)}),t.core.length&&(e+="\n\nCore updates:\n- "+t.core.join("\n- ")),t.modules.length&&(e+="\n\nModule updates:\n- "+t.modules.join("\n- ")),t.themes.length&&(e+="\n\nTheme updates:\n- "+t.themes.join("\n- ")),console.log(e)}else if("composer"===e){n=l;let t=[];n.forEach(e=>{var o;"unsupported"!==e.status&&d(e.installed)!==d(e.recommended)&&(o=d(e.recommended),e.name.toLowerCase().includes("core")?(t.push("drupal/core-recommended:^"+o),t.push("drupal/core-composer-scaffold:^"+o),t.push("drupal/core-project-message:^"+o),t.push("drupal/core:^"+o)):t.push(`drupal/${e.machine}:^`+o))}),t.length?console.log("composer require -W "+t.join(" ")):console.log("✅ No composer updates required.")}else"json"===e?console.log(JSON.stringify(l,null,2)):"csv"===e?(n=l,n=[s,...n.map(e=>[e.name,e.status,e.installed,e.recommended])].map(e=>e.map(p).join(",")).join("\n"),n=new Blob([n],{type:"text/csv"}),e=`drupal_updates_${window.location.hostname}_${r().replace(/\//g,"-")}.csv`,(t=document.createElement("a")).href=URL.createObjectURL(n),t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)):console.log("❓ Unknown report type.");var t}else console.log('✅ "generateUpdateReport" is ready to use'),console.log("📦 REPORT OUTPUT OPTIONS:\n"),console.log('🔹 generateUpdateReport("ascii"); → Display updates in an ASCII table'),console.log('🔹 generateUpdateReport("commit"); → Generate commit message'),console.log('🔹 generateUpdateReport("json"); → Output updates as JSON'),console.log('🔹 generateUpdateReport("composer"); → Generate composer require command'),console.log('🔹 generateUpdateReport("csv"); → Export CSV of updates'),console.log("\n🧰 EXCLUDE OPTIONS:\n"),console.log('🔹 generateUpdateReport("add_exclude", "module_name"); → Add a module to the exclude list'),console.log('🔹 generateUpdateReport("remove_exclude", "module_name"); → Remove a module from the exclude list'),console.log('🔹 generateUpdateReport("exclude_list"); → List all currently excluded modules')},generateUpdateReport("help")})();